# Unit 8
## Chapter 1: Outlining

In this chapter, you will begin using tools and scripts to AUTOMATICALLY outline the Rails app.  I HATE having to read through large amounts of code just to get a basic overview, and I HATE the idea of having to do that over and over again as the app progresses.  Furthermore, manually reading through a much larger and more complex application takes too long.  The outline.sh script takes care of this automatically.  If you use the tools described in this chapter, you can make sure that anyone on your team always has on-demand access to outlines of your app.

### New Branch
Enter the command "git checkout -b 08-01-outline".

### Gemfile
* Add the following code to the end of the Gemfile:
```
# BEGIN: for outline.sh
group :development do
  gem 'annotate' # Adds comments listing parameters and the output of "rails routes"
  gem 'railroady' # Generates block diagrams
  gem 'rails-erd' # Generates block diagrams
end
# END: for outline.sh
```
* Enter the command "sh git_check.sh".
* Enter the following commands:
```
git add .
git commit -m "Installed annotate, railroady, and rails-erd"
```
### outline-short.sh
* Create the file outline-short.sh with the following content:
```
#!/bin/bash

mkdir -p notes

file_he='notes/1-file_list-helpers.txt'
file_mo='notes/1-file_list-models.txt'
file_co='notes/1-file_list-controllers.txt'
file_vi='notes/1-file_list-views.txt'

sh pg-start.sh

echo '-----------------------------'
echo 'bundle exec annotate --routes'
bundle exec annotate --routes

echo '--------------------'
echo 'bundle exec annotate'
bundle exec annotate

echo '------------------------------------'
echo 'Listing the helper files in the file'
echo $file_he
echo 'This file was AUTOMATICALLY generated by the outline.sh script.' > $file_he
echo '-------------------' >> $file_he
echo 'HELPERS' >> $file_he
tree test/helpers >> $file_he
echo '' >> $file_he
tree app/helpers >> $file_he
echo '' >> $file_he

echo '-------------------------------'
echo 'Listing the model files in file'
echo $file_mo
echo 'This file was AUTOMATICALLY generated by the outline.sh script.' > $file_mo
echo '------' >> $file_mo
echo 'MODELS' >> $file_mo
tree test/models >> $file_mo
echo '' >> $file_mo
tree test/fixtures >> $file_mo
echo '' >> $file_mo
tree app/models >> $file_mo

echo 'This file was AUTOMATICALLY generated by the outline.sh script.' > $file_co
echo '-----------' >> $file_co
echo 'CONTROLLERS' >> $file_co
tree test/controllers >> $file_co
echo '' >> $file_co
tree app/controllers >> $file_co

echo 'This file was AUTOMATICALLY generated by the outline.sh script.' > $file_vi
echo '---------------------------' >> $file_vi
echo 'VIEWS AND INTEGRATION TESTS' >> $file_vi
echo '' >> $file_vi
echo '----------------' >> $file_vi
echo 'config/routes.rb' >> $file_vi
cat config/routes.rb >> $file_vi
echo '----------------' >> $file_vi
tree test/integration >> $file_vi
echo '' >> $file_vi
tree app/views >> $file_vi

echo 'FINISHED compiling the list of files that make up the MVC structure'
echo '-------------------------------------------------------------------'

echo '******************************'
echo 'outline-short.sh OUTPUT FILES:'
echo $file_he
echo $file_mo
echo $file_co
echo $file_vi
echo
```
* Enter the command "sh outline-short.sh".

### outline.sh
* Create the file outline.sh with the following content:
```
#!/bin/bash

sh outline-short.sh

d_mo='log/diagram-models.jpg'
d_co='log/diagram-controllers.jpg'
d_gems='log/diagram-gems.jpg'

echo '---------------'
echo 'Using rails-erd'
bundle exec erd --attributes=foreign_keys,primary_keys,timestamps,inheritance,content --filetype=dot --filename=log/diagram-models --inheritance --notation=bachman
dot -Tjpg log/diagram-models.dot > $d_mo
echo
echo "Models diagram is at $d_mo"
echo

echo '---------------'
echo 'Using railroady'
bundle exec railroady -i -l TestLabel -v -a --all-columns -j -m -p -z -t --engine-controllers -C | dot -Tjpg > $d_co
echo
echo "Controllers diagram is at $d_co"
echo

echo '-----------------------------------------------------'
echo 'Drawing gem dependency diagram (log/diagram-gems.jpg)'
bundle viz --file=log/diagram-gems --format=jpg --requirements --version

echo '************************'
echo 'outline.sh OUTPUT FILES:'
echo $d_mo
echo $d_co
echo $d_gems
echo 'Directory trees are in the notes directory.'
echo
```
* Enter the command "sh outline.sh".

### all.sh
* Edit the all.sh script.  Add the following code prior to the seed.sh section:
```
FILE_LOG_OUTLINE='log/all-outline.log'
echo '---------------------------------'
echo "sh outline.sh > $FILE_LOG_OUTLINE"
sh outline.sh > $FILE_LOG_OUTLINE

d_mo='log/diagram-models.jpg'
d_co='log/diagram-controllers.jpg'
d_gems='log/diagram-gems.jpg'

echo 'outline.sh OUTPUT FILES:'
echo $d_mo
echo $d_co
echo $d_gems
echo 'Directory trees are in the notes directory.'
```
* Enter the command "sh all.sh".

### git_check.sh
* Add the following lines to the end of the git_check.sh script:
```
sh outline-short.sh

echo '----------'
echo 'git status'
git status
```
* Enter the command "sh git_check.sh".
* Enter the following commands:
```
git add .
git commit -m "Added outlining scripts and annotations"
```

### Wrapping Up
* Enter the command "git push origin 08-01-outline".
* Go to the GitHub repository and click on the "Compare and pull request" button for this branch.
* Accept this pull request to merge it with the master branch, but do NOT delete this branch.
* Enter the following commands:
```
git checkout master
git pull
sh heroku.sh
```
